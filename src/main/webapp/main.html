<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>卡游宝</title>
    <style>
        @font-face {
            font-family: custom;       /*这里是说明调用来的字体名字*/
            src: url('./css/first.TTF');   /*这里是字体文件路径*/
        }

        html {
            height: 100%;
            width: 100%;
            background: #393F4F;
        }

        /* padding-top 控制距离标题距离*/
        .box {
            width: 100%;
            height: 100%;
            background: #393F4F;
            margin: auto;
            padding-top: 80px;
        }

        .user {
            background-color: #393F4F;
            height: 50px;
            margin-top: 10px;
        }

        .account {
            height: 170px;
            margin-top: 10px;
        }

        .join {
            margin-top: 30px;
            height: 60px;
            background-color: #4EB7CD;
            text-align: center;
            margin-left: 30px;
            margin-right: 30px;
        }

        .publish {
            margin-top: 20px;
            height: 40px;
            text-align: center;
        }

        .room {
            margin: 10px;
            margin-top: 10px;
            height: 80px;
            background-color: green;
            text-align: center;
        }

        a {
            text-decoration: none;
            color: #333;
        }

        .box_163css {
            width: 100%;
            position: fixed;
            background-color: #5A6378;
        }

        .nav {
            width: 100%;
            float: left;
            height: 34px;
        }

        .nav li {
            font-size: 14px;
            float: left;
            width: 33%;
            height: 34px;
            -webkit-transition: all 0.35s linear;
            cursor: pointer;
            text-align: center;
            line-height: 32px;
            list-style-type: none;
            color: white;
        }

        .nav li.on {
            color: #4EB7CD;
        }

        .line {
            width: 100%;
            float: left;
            position: relative;
            left: 0;
            top: 0px;
            height: 2px;
            background: #5A6378;
        }

        .s_line {
            position: absolute;
            display: block;
            width: 33%;
            z-index: 1;
            top: -7px;
            left: 0;
            height: 7px;
            border-bottom: 2px solid #4EB7CD;
            overflow: hidden;
            text-align: center;
        }

        .nav {
            background: #5A6378;
        }

        .s_line b {
            display: inline-block;
            margin-top: -8px;
            width: 0;
            height: 0;
            border-style: dashed dashed solid;
            border-width: 10px;
            border-color: transparent transparent #E4393C;
            overflow: hidden;
            zoom: 1;
            font-size: 0;
        }

        .zlbox_content {
            width: 100%;
            margin: 0px auto;
        }

        .item_tab {
            min-height: 100%;
            border-top: 0px;
            text-align: center;
        }

        .list_item {
            background-color: white;
            border-bottom: 1px solid gray;
        }

        .exit{
            font-family: custom;
            color: white;
            font-size: 15px;
            margin: 20px;
        }
    </style>
</head>

<body>
<div class="box">
    <div class="header" style="position:fixed;left:0px;top:0px;width:100%;z-index: 5; height: 50px; background-color: #5A6378">
        <table width="100% " height="50px" border="0" cellpadding="0 " cellspacing="0 ">
            <tr>
                <td width="40%" align="left">
                    <span class="exit" onclick="exit()">注销</span>
                </td>
                <td width="60% " align="right" style="padding-right: 10px; ">
                    <img src="./img/img_logo.png " width="120px " height="35px"
                         style="margin-right: 20px; margin-top: 10px"></img>
                </td>
            </tr>
        </table>

        <div class="box_163css">
            <ul class="nav">
                <li class="navs_li on">抽奖房间</li>
                <li class="navs_li">开奖房间</li>
                <li class="navs_li">个人信息</li>
            </ul>

            <div class="line">
	    	<span class="s_line">
				<b></b>
	    	</span>
                <div style="clear: both;"></div>
            </div>
            <div style="clear: both;"></div>
        </div>
    </div>

    <div class="zlbox_content">

        <!-- 抽奖房间-->
        <div class="item_tab" style="display: block;">
            <div class="user" onclick="showuser()">
                <table width="100% " height="50px " border="0" cellpadding=" " cellspacing="0 ">
                    <tr>
                        <td width="30% " align="center" style="padding: 5px; color: #5DABB8;">用户:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span
                                style="color: #5DABB8; margin-left: 0px;" id="username1"></span></td>
                    </tr>
                    <tr>
                        <td width="30% " align="center" style="padding: 5px;color: #5DABB8; ">账户积分:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span style="color: #5DABB8; "
                                                                                          id="token1"></span></td>
                    </tr>
                </table>
            </div>

            <div class="list" id="luckRoom" style="margin-top: 20px">
                <!--  <a href="#" class="">
                      <table width="100% " height="90px " border="0" cellpadding=" " cellspacing="0 " class="list_item">
                          <tr>
                              <td colspan="2" width="100% " align="left" style="padding-left: 15px; color: #FF6B6B;font-family: custom">房间名称</img>
                              </td>
                          </tr>
                          <tr>
                              <td width="50% " align="left" style="padding-left: 15px;color: gray; ">参与人数:50/100</img>
                              </td>
                              <td width="50% " align="right" style="padding-right: 10px "><span style="color: #5DABB8; "
                                                                                                id="num">价值:1299</span></td>
                          </tr>
                          <tr>
                              <td width="50% " align="left" style="padding-left: 15px;color: gray ">房间时间:18:00</img>
                              </td>
                              <td width="50% " align="left" style=""><span style="color: #5DABB8; "
                                                                                                id="time"></span></td>
                          </tr>
                      </table>
                  </a>
                  <a href="#" class="">
                      <table width="100% " height="90px " border="0" cellpadding=" " cellspacing="0 " class="list_item">
                          <tr>
                              <td colspan="2" width="100% " align="left" style="padding-left: 15px; color: #FF6B6B;font-family: custom">房间名称</img>
                              </td>
                          </tr>
                          <tr>
                              <td width="50% " align="left" style="padding-left: 15px;color: gray; ">参与人数:50/100</img>
                              </td>
                              <td width="50% " align="right" style="padding-right: 10px "><span style="color: #5DABB8; "
                                                                                                id="num">价值:1299</span></td>
                          </tr>
                          <tr>
                              <td width="50% " align="left" style="padding-left: 15px;color: gray ">房间时间:18:00</img>
                              </td>
                              <td width="50% " align="left" style=""><span style="color: #5DABB8; "
                                                                           id="time"></span></td>
                          </tr>
                      </table>
                  </a>-->
            </div>
        </div>

        <!-- 开奖房间 -->
        <div class="item_tab" style="display: none;">
            <div class="user" onclick="showuser()">
                <table width="100% " height="50px " border="0" cellpadding=" " cellspacing="0 ">
                    <tr>
                        <td width="30% " align="center" style="padding: 5px; color: #5DABB8;">用户:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span
                                style="color: #5DABB8; margin-left: 0px;" id="username2"></span></td>
                    </tr>
                    <tr>
                        <td width="30% " align="center" style="padding: 5px;color: #5DABB8; ">账户积分:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span style="color: #5DABB8; "
                                                                                          id="token2"></span></td>
                    </tr>
                </table>
            </div>

            <div class="list" id="kjRoom" style="margin-top: 20px">
                <a href="#" class="">
                    <table width="100% " height="90px " border="0" cellpadding=" " cellspacing="0 " class="list_item">
                        <tr>
                            <td colspan="2" width="100% " align="left" style="padding-left: 15px; color: #FF6B6B;font-family: custom">房间名称</img>
                            </td>
                        </tr>
                        <tr>
                            <td width="50% " align="left" style="padding-left: 15px;color: gray; ">参与人数:50/100</img>
                            </td>
                            <td width="50% " align="right" style="padding-right: 10px "><span style="color: #5DABB8; "
                                                                                              id=".">价值:1299</span></td>
                        </tr>
                        <tr>
                            <td width="50% " align="left" style="padding-left: 15px;color: gray ">房间时间:18:00</img>
                            </td>
                            <td width="50% " align="left" style=""><span style="color: #5DABB8; "
                                                                         id=""></span></td>
                        </tr>
                    </table>
                </a>
            </div>
        </div>

        <!-- 个人信息-->
        <div class="item_tab" style="display: none;">
            <div class="user" onclick="showuser()">
                <table width="100% " height="50px " border="0" cellpadding=" " cellspacing="0 ">
                    <tr>
                        <td width="30% " align="center" style="padding: 5px; color: #5DABB8;">用户:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span
                                style="color: #5DABB8; margin-left: 0px;" id="userId"></span></td>
                    </tr>
                    <tr>
                        <td width="30% " align="center" style="padding: 5px;color: #5DABB8; ">账户积分:</img>
                        </td>
                        <td width="70% " align="left" style="padding-right: 10px; "><span style="color: #5DABB8; " id="token"></span></td>
                    </tr>
                </table>
            </div>

            <div style="background-color: #404656;width: 100%;height: 2px;margin-top: 20px"></div>

            <div class="account">
                <table width="100% " height="100%" border="0" cellpadding=" " cellspacing="0 ">
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="40% " align="left" style="padding: 5px; color: white; ">账户地址:</img>
                        </td>
                        <td width="50% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="ethAddress"></span></td>
                    </tr>
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="40% " align="left" style="padding: 5px; color: white; ">发布活动数量：</img>
                        </td>
                        <td width="50% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="publishCount"></span></td>
                    </tr>
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="30% " align="left" style="padding: 5px; color: white; ">参与活动数量：</img>
                        </td>
                        <td width="60% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="joinCount"></span></td>
                    </tr>
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="30% " align="left" style="padding: 5px; color: white; ">缴纳保证金：</img>
                        </td>
                        <td width="60% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="amount"></span></td>
                    </tr>
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="30% " align="left" style="padding: 5px; color: white; ">联系方式：</img>
                        </td>
                        <td width="60% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="contact"></span></td>
                    </tr>
                    <tr>
                        <td width="10% " align="center" style="padding: 5px; color: white; "></img>
                        </td>
                        <td width="30% " align="left" style="padding: 5px; color: white; ">QQ：</img>
                        </td>
                        <td width="60% " align="left" style="padding-right: 10px; "><span
                                style="color: white; margin-left: 0px;" id="qq"></span></td>
                    </tr>
                </table>
            </div>

            <div style="background-color: #404656;width: 100%;height: 2px;margin-top: 20px"></div>

            <div class="publish">
                <table width="100%" border="0" cellpadding="0" cellspacing="0 ">
                    <tr>
                        <td style="color: white;font-family: custom; font-size: 20px" onclick="enterEthLotterDeploy()">发布活动</td>
                    </tr>
                </table>
            </div>

            <div class="room">
                <table width="100% " height="80px " border="0" cellpadding="10" cellspacing="10 "
                       style="background-color: #55C360; ">
                    <tr>
                        <td style="color: white; "><span style="font-family: custom; font-size: 20px;" onclick="enterLotterRoom()">开奖房间</span></td>
                        <td style="background-color: #5A6378; width: 10px;"></td>
                        <td style="color: white;" onclick="enterDrawluck()"><span style="font-family: custom; font-size: 20px;">抽奖房间</span></td><!--showluckRoom()-->
                    </tr>
                </table>
            </div>

            <div class="line" style="background-color: #404656;width: 100%;height: 2px;margin-top: 20px"></div>

            <div class="join">
                <table width="100% " height="60px " border="0" cellpadding="0" cellspacing="10 ">
                    <tr>
                        <td style="color: white;" onclick="controll()">庄家后台</td>
                    </tr>
                </table>
            </div>

            <div style="height: 200px">
            </div>
        </div>

    </div>

</div>

<script type="text/javascript ">
    $(document).ready(function () {
        getLuckRoom();
    });

    function showPublishRoom() {
        window.location.href = "publishroom.html"
    }

    function showluckRoom() {
        window.location.href = "roomlist.html"
    }

    function controll() {
        window.location.href = "roomcontroll.html"
    }

    function showuser() {
        window.location.href = "userinfo.html"
    }

    function enterLotterRoom() {
        location.href = "kjroom.html"
    }

    function enterEthLotterDeploy() {
        location.href = "ethlottery.html"
    }

    function enterDrawluck() {
        window.location.href = "luckroom.html"
    }

    var l = 0;
    $('.navs_li').hover(function () {
        $(this).siblings().removeClass('on');
        $(this).addClass('on');
        var i = $(this).index();
        var width = document.body.clientWidth;
        var a1 = width / 3 * i;
        $(".s_line").animate({left: a1}, 200);
        var index = $(".navs_li").index($(this));
        $(".item_tab").hide();
        $(".item_tab").eq(index).show();
        console.log("i=" + i);
        if (index == 0) {
            getLuckRoom();
        } else if (index == 1) {
            getkjRoom();
        } else if (index == 2) {
            getUserinfo();
        }
    });

    function getLuckRoom() {
        $.ajax({
            type: 'POST',
            url: "/activity/roominfo2",
            success: function (data) {
                if (data.code == 200) {
                    dataStr = JSON.stringify(data.data);
                    var data = JSON.parse(dataStr);
                    console.log("data=" + data.token);
                    $("#token1").html(data.token);
                    $("#username1").html(data.username);
                    $("#token2").html(data.token);
                    $("#username2").html(data.username);
                    console.log("list.size=" + data.list.size);
                    var str = "";
                    $.each(data.list, function (i, a) {
                        str +=
                            "<table width='100%' height='120px' border='0' cellspacing='0' class='list_item' onclick='goto(" + a.activityid + ")'>" +
                            "<tr>" +
                            "<td colspan='2' width='100%' align='left' style='padding-left: 15px; color: #FF6B6B;font-family: custom'>" + a.roomname + "</img>" +
                            "</td>" +
                            "</tr>" +
                            "<tr>" +
                            "<td width='50%'  align='left' style='padding-left: 15px;color: gray; '>" + "庄家用户名:" + a.adminName+ "</img>" +
                            "</td>" +
                            "<tr>" +
                            "<td width='50%'  align='left' style='padding-left: 15px;color: gray; '>" + "房间中奖几率:" + a.winrate + "%" + "</img>" +
                            "</td>" +
                            "<td width='50%' align='right' style='padding-right: 10px'><span style='color: #5DABB8;id='num'>" + "每次参与积分:" + a.token + "</span></td></tr>" +
                            "<tr><td width='50%' align='left' style='padding-left: 15px;color: gray'>" + "房间卡牌剩余数量:" + a.num + "</img> </td>" +
                            "<td width='50%' align='left'><span style='color: #5DABB8;' id='time'></span></td></tr></table>";
                        //alert(str);
                    })
                    $("#luckRoom").html(str);
                }
                if (data.code == 201) {
                    alert(data.msg);
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                //alert("error="+errorThrown);
            }
        });
    }

    function  getkjRoom() {

        //开奖房间
        $.ajax({
            type: 'POST',
            url: "/activity/kjroom/list",
            success: function (rs) {
                if (rs.code == 200) {
                    dataStr = JSON.stringify(rs.data);
                    dataArrs = JSON.parse(dataStr);
                    var kjstr = "";
                    for(i=0;i<dataArrs.length;i++){
                        //插入
                        dataArr = dataArrs[i];
                        dataHtml= "<a href="+"\"kjroominfo.html?activityid="+dataArr['id']+"\""+" class=\"\">"+
                            "                    <table width=\"100% \" height=\"90px \" border=\"0\" cellpadding=\" \" cellspacing=\"0 \" class=\"list_item\">\n" +
                            "                        <tr>\n" +
                            "                            <td colspan=\"2\" width=\"100% \" align=\"left\" style=\"padding-left: 15px; color: #FF6B6B;font-family: custom\">"+dataArr['activityname']+
                            "</td>\n" +
                            "                        </tr>\n" +
                            "                        <tr>\n" +
                            "                            <td width=\"50% \" align=\"left\" style=\"padding-left: 15px;color: gray; \">参与人数:"+(dataArr['num'])+"/"+dataArr['limitMax']+
                            " </td>\n" +
                            "                            <td width=\"50% \" align=\"right\" style=\"padding-right: 10px \"><span style=\"color: #5DABB8; \"\n" +
                            "                                                                                              id=\".\">价值:"+dataArr['allprice']+
                            "</span></td>\n" +
                            "                        </tr>\n" +
                            "                        <tr>\n" +
                            "                            <td width=\"50% \" align=\"left\" style=\"padding-left: 15px;color: gray \">结束时间:"+(dataArr['endBlock'])+
                            " </td>\n" +
                            "                            <td width=\"50% \" align=\"left\" style=\"\"><span style=\"color: #5DABB8; \"\n" +
                            "                                                                         id=\"\"></span></td>\n" +
                            "                        </tr>\n" +
                            "                    </table>\n" +
                            "                </a>";
                        kjstr = kjstr+dataHtml;
                    }
                    $("#kjRoom").html(kjstr);
                }

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {


            }
        });
    }

    /* 个人信息 */
    var flag = 0;

    function getUserinfo() {
        $(document).ready(function () {
            $.ajax({
                type: 'POST',
                url: "/user/main",
                success: function (data) {
                    if (data.code == 200) {
                        dataStr = JSON.stringify(data.data);
                        var data = JSON.parse(dataStr);
                        console.log("data=" + data.userId + " token " + data.token);
                        $("#userId").html(data.userName);
                        $("#token").html(data.token);
                        $("#ethAddress").html(data.ethAddress);
                        $("#contact").html(data.phone);
                        $("#publishCount").html(data.publishCount);
                        $("#amount").html(data.amount);
                        $("#joinCount").html(data.joinCount);
                        $("#qq").html(data.contact);
                        flag = data.flag;
                        if (flag == 0) {
                            $(".publish").hide();
                            $(".room").hide();
                            $(".join").hide();
                            $(".line").hide();
                        } else {
                            $(".publish").show();
                            $(".room").show();
                            $(".join").show();
                            $(".line").show();
                        }
                    }
                    if (data.code == 201) {
                        alert(data.msg);
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                }
            });
        });
    }

    function goto(activityId) {
        window.location.href = "roominfo.html?activityid=" + activityId;
    }

    function exit() {
        window.location.href = "login.html";
    }
</script>
</body>

</html>